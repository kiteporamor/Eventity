# language: ru
@2FA
Функционал: Двухфакторная аутентификация

  Сценарий: Успешная аутентификация с 2FA
    Дано существует технический пользователь с логином 'techuser' и паролем 'TestPass123!'
    И включена двухфакторная аутентификация
    Когда пользователь пытается войти с логином 'techuser' и паролем 'TestPass123!'
    Тогда требуется ввести код подтверждения
    И получен код подтверждения по email
    Когда пользователь вводит правильный код подтверждения
    Тогда аутентификация успешна и выдан JWT токен
    И получен доступ к защищенным ресурсам

  @PasswordChange
  Сценарий: Плановая смена пароля после аутентификации
    Дано существует технический пользователь с логином 'changepassuser' и паролем 'OldPass123!'
    И пользователь успешно аутентифицирован с 2FA
    Когда пользователь отправляет запрос на смену пароля с текущим паролем 'OldPass123!' и новым паролем 'NewPass456!'
    Тогда смена пароля успешна
    И пользователь может войти с новым паролем 'NewPass456!'